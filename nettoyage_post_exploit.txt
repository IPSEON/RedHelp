# Nettoyage post-exploitation - Effacer ses traces proprement

ğŸ¯ Objectif : Ne pas laisser de traces de ton passage aprÃ¨s un accÃ¨s systÃ¨me.
ğŸ’¡ Attention : Ã  utiliser uniquement dans un contexte autorisÃ© (CTF, test pro avec accord Ã©crit).

---

ğŸ”¹ 1. Nettoyer lâ€™historique de commandes Bash

Les utilisateurs Linux laissent des traces dans :
- ~/.bash_history
- HISTFILE (variable dâ€™environnement)

â¤ Commandes Ã  exÃ©cuter :

    history -c                     # vide l'historique actuel
    unset HISTFILE                # dÃ©sactive l'historique temporairement
    rm ~/.bash_history            # supprime le fichier
    echo "" > ~/.bash_history     # vide sans supprimer

---

ğŸ”¹ 2. Supprimer les fichiers temporaires utilisÃ©s

Supprime les payloads, reverse shells, outils transfÃ©rÃ©s :

    rm /tmp/reverse.sh
    rm /home/victim/exploit.py
    rm -rf /var/tmp/lolbin.sh

Utilise `shred` si tu veux Ã©craser les donnÃ©es (plus discret) :

    shred -u mon_fichier_secret.txt

---

ğŸ”¹ 3. Effacer les journaux systÃ¨mes (âš ï¸ RisquÃ© !)

Certaines actions sont enregistrÃ©es dans `/var/log` :
- auth.log : connexions SSH, sudo
- bash.log, syslog, messagesâ€¦

âš ï¸ Cela peut casser des services ou alerter des systÃ¨mes de dÃ©tection.

    echo > /var/log/auth.log
    echo > /var/log/syslog
    > /var/log/messages

Astuce plus soft :
    find /var/log -type f -exec truncate -s 0 {} \;

---

ğŸ”¹ 4. Supprimer des utilisateurs ajoutÃ©s (si escalade)

    userdel -r hacker
    groupdel backdoor_group

---

ğŸ”¹ 5. Nettoyage de cron / persistence

VÃ©rifie que tu nâ€™as rien laissÃ© dans :
    crontab -l
    ls -la /etc/cron*

Et supprime ce que tu as ajoutÃ© :
    crontab -r

---

ğŸ”¹ 6. Effacer les accÃ¨s rÃ©seau / tunnels

    killall ssh
    killall nc
    iptables -F            # (optionnel, Ã  Ã©viter en prod !)

---

ğŸ”¹ 7. Nettoyage Metasploit

Si tu as utilisÃ© Meterpreter :
    clearev     # supprime les logs dâ€™Ã©vÃ©nements
    timestomp   # modifie les dates dâ€™accÃ¨s de fichier

---

ğŸ§  BONNES PRATIQUES :

âœ… Toujours vÃ©rifier ce que tu supprimes  
âœ… Ne JAMAIS faire Ã§a sur une machine sans autorisation  
âœ… En CTF : nettoie tout avant de valider si requis  
âœ… En entreprise : laisse les traces pour lâ€™analyse (souvent demandÃ©)

---

ğŸ’¬ Exemple final (en root ou sudo) :

```bash
history -c && unset HISTFILE
rm -rf /tmp/* /var/tmp/* ~/payloads/*
truncate -s 0 /var/log/*
